parser.setcontenthandler(contenthandler);if(saxentityresolver!=null)parser.setentityresolver(saxentityresolver);if(saxdtdhandler!=null)parser.setdtdhandler(saxdtdhandler);elseparser.setdtdhandler(contenthandler);if(saxerrorhandler!=null)parser.seterrorhandler(saxerrorhandler);elseparser.seterrorhandler(newbuildererrorhandler());booleansuccess=false;tryparser.setproperty(sax_property_lexical_handler,contenthandler);success=true;catch(finalsaxnotsupportedexceptione)catch(finalsaxnotrecognizedexceptione)if(!success)tryparser.setproperty(sax_property_lexical_handler_alt,contenthandler);success=true;catch(finalsaxnotsupportedexceptione)catch(finalsaxnotrecognizedexceptione)for(finalmap.entry<string,boolean>me:features.entryset())internalsetfeature(parser,me.getkey(),me.getvalue().booleanvalue(),me.getkey());for(finalmap.entry<string,object>me:properties.entryset())internalsetproperty(parser,me.getkey(),me.getvalue(),me.getkey());tryif(parser.getfeature(sax_feature_external_ent)!=expand)parser.setfeature(sax_feature_external_ent,expand);catch(finalsaxexceptione)if(!expand)tryparser.setproperty(sax_property_declaration_handler,contenthandler);success=true;catch(finalsaxnotsupportedexceptione)catch(finalsaxnotrecognizedexceptione)
finalcharsequencemapresult=newcharsequencemap(arraysizehint);while(valuesiter.hasnext())finalasciistringlowercased=httpheadernames.of(valuesiter.next()).tolowercase();tryintindex=lowercased.foreachbyte(find_comma);if(index!=-1)intstart=0;doresult.add(lowercased.subsequence(start,index,false).trim(),empty_string);start=index+1;while(start<lowercased.length()&&(index=lowercased.foreachbyte(start,lowercased.length()-start,find_comma))!=-1);result.add(lowercased.subsequence(start,lowercased.length(),false).trim(),empty_string);elseresult.add(lowercased.trim(),empty_string);catch(exceptione)thrownewillegalstateexception(e);returnresult;
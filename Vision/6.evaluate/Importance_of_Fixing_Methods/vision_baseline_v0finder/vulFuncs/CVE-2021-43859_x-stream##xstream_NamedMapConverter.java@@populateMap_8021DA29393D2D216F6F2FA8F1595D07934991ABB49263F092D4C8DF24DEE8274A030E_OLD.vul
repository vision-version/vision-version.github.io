singlevalueconverterkeyconverter=null;singlevalueconvertervalueconverter=null;if(keyasattribute)keyconverter=getsinglevalueconverter(keytype,"key");if(valueasattribute||valuename==null)valueconverter=getsinglevalueconverter(valuetype,"value");while(reader.hasmorechildren())objectkey=null;objectvalue=null;if(entryname!=null)reader.movedown();if(keyconverter!=null)stringattribute=reader.getattribute(keyname);if(attribute!=null)key=keyconverter.fromstring(attribute);if(valueasattribute&&valueconverter!=null)stringattribute=reader.getattribute(valuename);if(attribute!=null)value=valueconverter.fromstring(attribute);if(keyconverter==null)reader.movedown();if(valueconverter==null&&!keyname.equals(valuename)&&reader.getnodename().equals(valuename))value=readitem(valuetype,reader,context,map);elsekey=readitem(keytype,reader,context,map);reader.moveup();if(valueconverter==null)reader.movedown();if(keyconverter==null&&key==null&&value!=null)key=readitem(keytype,reader,context,map);elsevalue=readitem(valuetype,reader,context,map);reader.moveup();elseif(!valueasattribute)value=valueconverter.fromstring(reader.getvalue());target.put(key,value);if(entryname!=null)reader.moveup();
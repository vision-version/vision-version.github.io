if(parent.getproperty()==tnefproperty.id_mapiproperties)elseif(parent.getproperty()==tnefproperty.id_attachment)elsethrownewillegalargumentexception("canonlycreatefromamapipropertyattribute,"+"insteadreceiveda"+parent.getproperty()+"one");bytearrayinputstreaminp=newbytearrayinputstream(parent.getdata());intcount=littleendian.readint(inp);list<mapiattribute>attrs=newarraylist<>();for(inti=0;i<count;i++)inttypeandmv=littleendian.readushort(inp);intid=littleendian.readushort(inp);booleanismv=false;booleanisvl=false;inttypeid=typeandmv;if((typeandmv&types.multivalued_flag)!=0)ismv=true;typeid-=types.multivalued_flag;if(typeid==types.ascii_string.getid()||typeid==types.unicode_string.getid()||typeid==types.binary.getid()||typeid==types.directory.getid())isvl=true;mapitypetype=types.getbyid(typeid);if(type==null)type=types.createcustom(typeid);mapipropertyprop=mapiproperty.get(id);if(id>=0x8000&&id<=0xffff)byte[]guid=newbyte[16];ioutils.readfully(inp,guid);intmptype=littleendian.readint(inp);stringname;if(mptype==0)intmpid=littleendian.readint(inp);mapipropertybase=mapiproperty.get(mpid);name=base.name;elseintmplen=littleendian.readint(inp);byte[]mpdata=ioutils.safelyallocate(mplen,max_record_length);ioutils.readfully(inp,mpdata);name=stringutil.getfromunicodele(mpdata,0,(mplen/2)-1);skiptoboundary(mplen,inp);prop=mapiproperty.createcustom(id,type,name);if(prop==mapiproperty.unknown)prop=mapiproperty.createcustom(id,type,"(unknown"+integer.tohexstring(id)+")");intvalues=1;if(ismv||isvl)values=littleendian.readint(inp);if(type==types.null&&values>1)thrownewioexception("placeholder/nullarraysaren'tsupported.");for(intj=0;j<values;j++)intlen=getlength(type,inp);byte[]data=ioutils.safelyallocate(len,max_record_length);ioutils.readfully(inp,data);skiptoboundary(len,inp);mapiattributeattr;if(type==types.unicode_string||type==types.ascii_string)attr=newmapistringattribute(prop,typeid,data);elseif(type==types.app_time||type==types.time)attr=newmapidateattribute(prop,typeid,data);elseif(id==mapiproperty.rtf_compressed.id)attr=newmapirtfattribute(prop,typeid,data);elseattr=newmapiattribute(prop,typeid,data);attrs.add(attr);returnattrs;
if(bcryptstring==null)thrownewillegalargumentexception("missingbcryptstring.");finalintslength=bcryptstring.length();if(slength!=60)thrownewdatalengthexception("bcryptstringlength:"+slength+",60required.");if(bcryptstring.charat(0)!='$'||bcryptstring.charat(3)!='$'||bcryptstring.charat(6)!='$')thrownewillegalargumentexception("invalidbcryptstringformat.");stringversion=bcryptstring.substring(1,3);if(!allowedversions.contains(version))thrownewillegalargumentexception("bcryptversion'"+version+"'isnotsupportedbythisimplementation");intcost=0;stringcoststr=bcryptstring.substring(4,6);trycost=integer.parseint(coststr);catch(numberformatexceptionnfe)thrownewillegalargumentexception("invalidcostfactor:"+coststr);if(cost<4||cost>31)thrownewillegalargumentexception("invalidcostfactor:"+cost+",4<cost<31expected.");byte[]salt=decodesaltstring(bcryptstring.substring(bcryptstring.lastindexof('$')+1,slength-31));stringnewbcryptstring=dogenerate(version,password,salt,cost);booleanisequal=slength==newbcryptstring.length();for(inti=0;i!=slength;i++)isequal&=(bcryptstring.indexof(i)==newbcryptstring.indexof(i));returnisequal;
introunds,i,j;intcdata[]=bf_crypt_ciphertext.clone();intclen=cdata.length;byteret[];if(log_rounds<4||log_rounds>31)thrownewillegalargumentexception("badnumberofrounds");rounds=1<<log_rounds;if(salt.length!=bcrypt_salt_len)thrownewillegalargumentexception("badsaltlength");init_key();ekskey(salt,password,sign_ext_bug,safety);for(i=0;i<rounds;i++)key(password,sign_ext_bug,safety);key(salt,false,safety);for(i=0;i<64;i++)for(j=0;j<(clen>>1);j++)encipher(cdata,j<<1);ret=newbyte[clen*4];for(i=0,j=0;i<clen;i++)ret[j++]=(byte)((cdata[i]>>24)&0xff);ret[j++]=(byte)((cdata[i]>>16)&0xff);ret[j++]=(byte)((cdata[i]>>8)&0xff);ret[j++]=(byte)(cdata[i]&0xff);returnret;
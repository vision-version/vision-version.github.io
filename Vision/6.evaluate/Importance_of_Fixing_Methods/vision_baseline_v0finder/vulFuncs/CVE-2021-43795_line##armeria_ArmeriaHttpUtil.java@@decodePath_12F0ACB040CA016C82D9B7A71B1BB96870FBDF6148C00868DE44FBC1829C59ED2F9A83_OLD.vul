if(path.indexof('%')<0)returnpath;finalintlen=path.length();try(temporarythreadlocalstempthreadlocals=temporarythreadlocals.acquire())finalbyte[]buf=tempthreadlocals.bytearray(len);intdstlen=0;for(inti=0;i<len;i++)finalcharch=path.charat(i);if(ch!='%')buf[dstlen++]=(byte)((ch&0xff80)==0?ch:0xff);continue;finalinthexend=i+3;if(hexend>len)buf[dstlen++]=(byte)0xff;break;finalintdigit1=decodehexnibble(path.charat(++i));finalintdigit2=decodehexnibble(path.charat(++i));if(digit1<0||digit2<0)buf[dstlen++]=(byte)0xff;elsebuf[dstlen++]=(byte)((digit1<<4)|digit2);returnnewstring(buf,0,dstlen,standardcharsets.utf_8);
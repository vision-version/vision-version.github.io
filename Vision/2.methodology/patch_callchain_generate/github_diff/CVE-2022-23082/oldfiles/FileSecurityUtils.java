package io.whitesource.cure;
import java.io.File;
import java.io.IOException;
import lombok.NonNull;
import org.apache.commons.io.FilenameUtils;
public class FileSecurityUtils {
  public static boolean isFileOutsideDir( @NonNull final String filePath, @NonNull final String baseDirPath) throws IOException {
    File file = new File(filePath);
    File baseDir = new File(baseDirPath);
    return !file.getCanonicalPath().startsWith(baseDir.getCanonicalPath());
  }
  
  public static String normalize(final String filePath) {
    if (filePath == null) {
      return null;
    }
    
    return FilenameUtils.normalize(filePath);
  }
  
}


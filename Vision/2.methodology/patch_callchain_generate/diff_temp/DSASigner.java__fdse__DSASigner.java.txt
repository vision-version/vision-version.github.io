diff --git a/github_diff/CVE-2016-1000342/oldfiles/DSASigner.java b/github_diff/CVE-2016-1000342/newfiles/DSASigner.java
index 6f3dfaf..6f3bcf5 100644
--- a/github_diff/CVE-2016-1000342/oldfiles/DSASigner.java
+++ b/github_diff/CVE-2016-1000342/newfiles/DSASigner.java
@@ -27,6 +27,7 @@ import org.bouncycastle.crypto.digests.SHA3Digest;
 import org.bouncycastle.crypto.digests.SHA512Digest;
 import org.bouncycastle.crypto.params.ParametersWithRandom;
 import org.bouncycastle.crypto.signers.HMacDSAKCalculator;
+import org.bouncycastle.util.Arrays;
 public class DSASigner extends SignatureSpi implements PKCSObjectIdentifiers, X509ObjectIdentifiers {
     private Digest                  digest;
     private DSA                     signer;
@@ -117,6 +118,10 @@ public class DSASigner extends SignatureSpi implements PKCSObjectIdentifiers, X5
             throw new IOException("malformed signature");
         }
         
+        if (!Arrays.areEqual(encoding, s.getEncoded(ASN1Encoding.DER))){
+            throw new IOException("malformed signature");
+        }
+        
         return new BigInteger[]{             ((ASN1Integer)s.getObjectAt(0)).getValue(), ((ASN1Integer)s.getObjectAt(1)).getValue() };
     }
     

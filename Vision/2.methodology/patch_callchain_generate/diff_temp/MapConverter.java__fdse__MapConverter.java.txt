diff --git a/github_diff/CVE-2021-43859/oldfiles/MapConverter.java b/github_diff/CVE-2021-43859/newfiles/MapConverter.java
index 74f3d72..cdd89a2 100644
--- a/github_diff/CVE-2021-43859/oldfiles/MapConverter.java
+++ b/github_diff/CVE-2021-43859/newfiles/MapConverter.java
@@ -1,6 +1,7 @@
 package com.thoughtworks.xstream.converters.collections;
 import com.thoughtworks.xstream.converters.MarshallingContext;
 import com.thoughtworks.xstream.converters.UnmarshallingContext;
+import com.thoughtworks.xstream.core.SecurityUtils;
 import com.thoughtworks.xstream.io.ExtendedHierarchicalStreamWriterHelper;
 import com.thoughtworks.xstream.io.HierarchicalStreamReader;
 import com.thoughtworks.xstream.io.HierarchicalStreamWriter;
@@ -67,7 +68,9 @@ public class MapConverter extends AbstractCollectionConverter {
     protected void putCurrentEntryIntoMap(HierarchicalStreamReader reader, UnmarshallingContext context, Map map, Map target) {
         final Object key = readCompleteItem(reader, context, map);
         final Object value = readCompleteItem(reader, context, map);
+        long now = System.currentTimeMillis();
         target.put(key, value);
+        SecurityUtils.checkForCollectionDoSAttack(context, now);
     }
     
     protected Object createCollection(Class type) {

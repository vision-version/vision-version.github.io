diff --git a/./github_diff/CVE-2014-4172/oldfiles/AbstractUrlBasedTicketValidator.java b/./github_diff/CVE-2014-4172/newfiles/AbstractUrlBasedTicketValidator.java
index e9e73ed..bbfcd4f 100644
--- a/./github_diff/CVE-2014-4172/oldfiles/AbstractUrlBasedTicketValidator.java
+++ b/./github_diff/CVE-2014-4172/newfiles/AbstractUrlBasedTicketValidator.java
@@ -31,7 +31,7 @@ public abstract class AbstractUrlBasedTicketValidator implements TicketValidator
         final Map<String, String> urlParameters = new HashMap<String, String>();
         logger.debug("Placing URL parameters in map.");
         urlParameters.put("ticket", ticket);
-        urlParameters.put("service", encodeUrl(serviceUrl));
+        urlParameters.put("service", serviceUrl);
         if (this.renew) {
             urlParameters.put("renew", "true");
         }
@@ -59,7 +59,8 @@ public abstract class AbstractUrlBasedTicketValidator implements TicketValidator
                 buffer.append(i++ == 0 ? "?" : "&");
                 buffer.append(key);
                 buffer.append("=");
-                buffer.append(value);
+                final String encodedValue = encodeUrl(value);
+                buffer.append(encodedValue);
             }
             
         }

diff --git a/./github_diff/CVE-2022-24197/oldfiles/PdfReader.java b/./github_diff/CVE-2022-24197/newfiles/PdfReader.java
index 7a7a23f..40b3fd4 100644
--- a/./github_diff/CVE-2022-24197/oldfiles/PdfReader.java
+++ b/./github_diff/CVE-2022-24197/newfiles/PdfReader.java
@@ -20,6 +20,7 @@ import java.io.FileNotFoundException;
 import java.io.IOException;
 import java.io.InputStream;
 import java.util.HashSet;
+import java.nio.charset.StandardCharsets;
 import java.util.Map;
 import com.itextpdf.kernel.xmp.XMPException;
 import com.itextpdf.kernel.xmp.XMPMetaFactory;
@@ -658,9 +659,9 @@ public class PdfReader implements Closeable {
             PdfObject obj = readObject(true, objStm);
             if (obj == null) {
                 if (tokens.getTokenType() == PdfTokenizer.TokenType.EndDic)
-                    tokens.throwError(KernelExceptionMessageConstant.UNEXPECTED_GT_GT);
+                    tokens.throwError(MessageFormatUtil. format(KernelExceptionMessageConstant.UNEXPECTED_TOKEN, ">>"));
                 if (tokens.getTokenType() == PdfTokenizer.TokenType.EndArray)
-                    tokens.throwError(KernelExceptionMessageConstant.UNEXPECTED_CLOSE_BRACKET);
+                    tokens.throwError(MessageFormatUtil. format(KernelExceptionMessageConstant.UNEXPECTED_TOKEN, "]"));
             }
             
             dic.put(name, obj);
@@ -674,10 +675,11 @@ public class PdfReader implements Closeable {
         while (true) {
             PdfObject obj = readObject(true, objStm);
             if (obj == null) {
-                if (tokens.getTokenType() == PdfTokenizer.TokenType.EndArray)
+                if (tokens.getTokenType() != PdfTokenizer.TokenType.EndArray) {
+                    processArrayReadError();
+                }
+                
                 break;
-                if (tokens.getTokenType() == PdfTokenizer.TokenType.EndDic)
-                    tokens.throwError(KernelExceptionMessageConstant.UNEXPECTED_GT_GT);
             }
             
             array.add(obj);
@@ -1058,6 +1060,18 @@ public class PdfReader implements Closeable {
         return memorySavingMode;
     }
     
+    private void processArrayReadError() {
+        final String error = MessageFormatUtil.format(KernelExceptionMessageConstant.UNEXPECTED_TOKEN, new String(tokens.getByteContent(), StandardCharsets.UTF_8));
+        if (StrictnessLevel.CONSERVATIVE.isStricter(this.getStrictnessLevel())) {
+            final Logger logger = LoggerFactory.getLogger(PdfReader.class);
+            logger.error(error);
+        }
+         else {
+            tokens.throwError(error);
+        }
+        
+    }
+    
     private void readDecryptObj() {
         if (encrypted)
             return;

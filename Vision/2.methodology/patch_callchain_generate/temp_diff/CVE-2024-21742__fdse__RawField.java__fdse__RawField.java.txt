diff --git a/./github_diff/CVE-2024-21742/oldfiles/RawField.java b/./github_diff/CVE-2024-21742/newfiles/RawField.java
index fe3f6ba..64a5ee3 100644
--- a/./github_diff/CVE-2024-21742/oldfiles/RawField.java
+++ b/./github_diff/CVE-2024-21742/newfiles/RawField.java
@@ -24,6 +24,31 @@ public final class RawField implements Field {
     
     public RawField(String name, String body) {
         this(null, -1, name, body);
+        int pos = 0;
+        while (true) {
+            pos = body.indexOf('\r', pos);
+            if (pos < 0) {
+                break;
+            }
+            
+            if (pos < body.length() + 2) {
+                if (body.charAt(pos + 1) != '\n') {
+                    throw new IllegalArgumentException("Injection of un-encoded line breaks inside header field could be assimilated to header injection");
+                }
+                
+                if (pos != body.length() - 2 && !isSpace(body, pos + 2)) {
+                    throw new IllegalArgumentException("Injection of un-encoded line breaks inside header field could be assimilated to header injection");
+                }
+                
+            }
+            
+            pos ++;
+        }
+        
+    }
+    
+    private static boolean isSpace(String body, int pos) {
+        return body.charAt(pos) == ' ' || body.charAt(pos) == '\t';
     }
     
     public ByteSequence getRaw() {

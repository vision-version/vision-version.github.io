diff --git a/./github_diff/CVE-2017-1000487/oldfiles/Commandline.java b/./github_diff/CVE-2017-1000487/newfiles/Commandline.java
index f6c8aea..e23ed0f 100644
--- a/./github_diff/CVE-2017-1000487/oldfiles/Commandline.java
+++ b/./github_diff/CVE-2017-1000487/newfiles/Commandline.java
@@ -93,7 +93,7 @@ public class Commandline implements Cloneable {
         
         public int getPosition() {
             if ( realPos == -1 ){
-                realPos = ( getExecutable() == null ? 0 : 1 );
+                realPos = ( getLiteralExecutable() == null ? 0 : 1 );
                 for ( int i = 0; i < position; i++ ){
                     Arg arg = (Arg) arguments.elementAt( i );
                     realPos += arg.getParts().length;
@@ -178,6 +178,10 @@ public class Commandline implements Cloneable {
         this.executable = executable;
     }
     
+    public String getLiteralExecutable() {
+        return executable;
+    }
+    
     public String getExecutable() {
         String exec = shell.getExecutable();
         if ( exec == null ){
@@ -233,7 +237,7 @@ public class Commandline implements Cloneable {
     
     public String[] getCommandline() {
         final String[] args = getArguments();
-        String executable = getExecutable();
+        String executable = getLiteralExecutable();
         if ( executable == null ){
             return args;
         }
@@ -326,7 +330,7 @@ public class Commandline implements Cloneable {
         File workingDir = shell.getWorkingDirectory();
         try {
             if ( workingDir == null ){
-                process = Runtime.getRuntime().exec( getShellCommandline(), environment );
+                process = Runtime.getRuntime().exec( getCommandline(), environment, workingDir );
             }
             
             else{
@@ -338,7 +342,7 @@ public class Commandline implements Cloneable {
                     throw new CommandLineException( "Path \"" + workingDir.getPath() + "\" does not specify a directory." );
                 }
                 
-                process = Runtime.getRuntime().exec( getShellCommandline(), environment, workingDir );
+                process = Runtime.getRuntime().exec( getCommandline(), environment, workingDir );
             }
             
         }
@@ -355,7 +359,7 @@ public class Commandline implements Cloneable {
             shell.setWorkingDirectory( workingDir );
         }
         
-        if ( shell.getExecutable() == null ){
+        if ( shell.getOriginalExecutable() == null ){
             shell.setExecutable( executable );
         }
         

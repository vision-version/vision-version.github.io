diff --git a/./github_diff/CVE-2022-23082/oldfiles/FileSecurityUtils.java b/./github_diff/CVE-2022-23082/newfiles/FileSecurityUtils.java
index 49fc161..928ae0b 100644
--- a/./github_diff/CVE-2022-23082/oldfiles/FileSecurityUtils.java
+++ b/./github_diff/CVE-2022-23082/newfiles/FileSecurityUtils.java
@@ -7,7 +7,7 @@ public class FileSecurityUtils {
   public static boolean isFileOutsideDir( @NonNull final String filePath, @NonNull final String baseDirPath) throws IOException {
     File file = new File(filePath);
     File baseDir = new File(baseDirPath);
-    return !file.getCanonicalPath().startsWith(baseDir.getCanonicalPath());
+    return !file.getCanonicalFile().toPath().startsWith(baseDir.getCanonicalFile().toPath());
   }
   
   public static String normalize(final String filePath) {

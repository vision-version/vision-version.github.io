diff --git a/./github_diff/CVE-2018-1261/oldfiles/UnZipTransformer.java b/./github_diff/CVE-2018-1261/newfiles/UnZipTransformer.java
index 9368e60..2251297 100644
--- a/./github_diff/CVE-2018-1261/oldfiles/UnZipTransformer.java
+++ b/./github_diff/CVE-2018-1261/newfiles/UnZipTransformer.java
@@ -11,6 +11,7 @@ import org.apache.commons.io.IOUtils;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.zeroturnaround.zip.ZipEntryCallback;
+import org.zeroturnaround.zip.ZipException;
 import org.zeroturnaround.zip.ZipUtil;
 import org.springframework.messaging.Message;
 import org.springframework.messaging.MessageHandlingException;
@@ -71,6 +72,10 @@ public class UnZipTransformer extends AbstractZipTransformer {
 							final File tempDir = new File(workDirectory, message.getHeaders().getId().toString());
 							tempDir.mkdirs(); 
 							final File destinationFile = new File(tempDir, zipEntryName);
+							 if (zipEntryName.contains("..") && !destinationFile.getCanonicalPath().startsWith(workDirectory.getCanonicalPath())) {
+								throw new ZipException("The file " + zipEntryName + " is trying to leave the target output directory of " + workDirectory);
+							}
+							
 							if (zipEntry.isDirectory()) {
 								destinationFile.mkdirs(); 
 							}

diff --git a/./github_diff/CVE-2018-1002201/oldfiles/ZipUtil.java b/./github_diff/CVE-2018-1002201/newfiles/ZipUtil.java
index 1557e46..2811461 100644
--- a/./github_diff/CVE-2018-1002201/oldfiles/ZipUtil.java
+++ b/./github_diff/CVE-2018-1002201/newfiles/ZipUtil.java
@@ -679,6 +679,10 @@ public final class ZipUtil {
       String name = mapper.map(zipEntry.getName());
       if (name != null) {
         File file = new File(outputDir, name);
+        if (name.indexOf("..") != -1 && !file.getCanonicalPath().startsWith(outputDir.getCanonicalPath())) {
+          throw new ZipException("The file "+name+" is trying to leave the target output directory of "+outputDir+". Ignoring this file.");
+        }
+        
         if (zipEntry.isDirectory()) {
           FileUtils.forceMkdir(file);
         }
@@ -731,11 +735,19 @@ public final class ZipUtil {
           }
           
           File destFile = new File(parentDirectory, dirs[dirs.length - 1]);
+          if (name.indexOf("..") != -1 && !destFile.getCanonicalPath().startsWith(outputDir.getCanonicalPath())) {
+            throw new ZipException("The file "+name+" is trying to leave the target output directory of "+outputDir+". Ignoring this file.");
+          }
+          
           FileUtils.copy(in, destFile);
         }
         
         else {
           File destFile = new File(outputDir, name);
+          if (name.indexOf("..") != -1 && !destFile.getCanonicalPath().startsWith(outputDir.getCanonicalPath())) {
+            throw new ZipException("The file "+name+" is trying to leave the target output directory of "+outputDir+". Ignoring this file.");
+          }
+          
           FileUtils.copy(in, destFile);
         }
         
@@ -767,6 +779,10 @@ public final class ZipUtil {
       String name = mapper.map(getUnrootedName(root, zipEntry.getName()));
       if (name != null) {
         File file = new File(outputDir, name);
+        if (name.indexOf("..") != -1 && !file.getCanonicalPath().startsWith(outputDir.getCanonicalPath())) {
+          throw new ZipException("The file "+name+" is trying to leave the target output directory of "+outputDir+". Ignoring this file.");
+        }
+        
         if (zipEntry.isDirectory()) {
           FileUtils.forceMkdir(file);
         }

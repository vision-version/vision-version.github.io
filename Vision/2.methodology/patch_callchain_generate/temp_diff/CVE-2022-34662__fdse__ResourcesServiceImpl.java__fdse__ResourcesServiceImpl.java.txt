diff --git a/./github_diff/CVE-2022-34662/oldfiles/ResourcesServiceImpl.java b/./github_diff/CVE-2022-34662/newfiles/ResourcesServiceImpl.java
index ffd7b17..13289a7 100644
--- a/./github_diff/CVE-2022-34662/oldfiles/ResourcesServiceImpl.java
+++ b/./github_diff/CVE-2022-34662/newfiles/ResourcesServiceImpl.java
@@ -82,6 +82,11 @@ public class ResourcesServiceImpl extends BaseServiceImpl implements ResourcesSe
             return result;
         }
         
+        if (FileUtils.directoryTraversal(name)) {
+            putMsg(result, Status.VERIFY_PARAMETER_NAME_FAILED);
+            return result;
+        }
+        
         String fullName = currentDir.equals("/") ? String.format("%s%s",currentDir,name) : String.format("%s/%s",currentDir,name);
         result = verifyResource(loginUser, type, fullName, pid);
         if (!result.getCode().equals(Status.SUCCESS.getCode())) {
@@ -416,6 +421,18 @@ public class ResourcesServiceImpl extends BaseServiceImpl implements ResourcesSe
     private Result<Object> verifyFile(String name, ResourceType type, MultipartFile file) {
         Result<Object> result = new Result<>();
         putMsg(result, Status.SUCCESS);
+        if (FileUtils.directoryTraversal(name)) {
+            logger.error("file alias name {} verify failed", name);
+            putMsg(result, Status.VERIFY_PARAMETER_NAME_FAILED);
+            return result;
+        }
+        
+        if (file != null && FileUtils.directoryTraversal(Objects.requireNonNull(file.getOriginalFilename()))) {
+            logger.error("file original name {} verify failed", file.getOriginalFilename());
+            putMsg(result, Status.VERIFY_PARAMETER_NAME_FAILED);
+            return result;
+        }
+        
         if (file != null) {
             if (file.isEmpty()) {
                 logger.error("file is empty: {}", RegexUtils.escapeNRT(file.getOriginalFilename()));
@@ -766,6 +783,11 @@ public class ResourcesServiceImpl extends BaseServiceImpl implements ResourcesSe
             return result;
         }
         
+        if (FileUtils.directoryTraversal(fileName)) {
+            putMsg(result, Status.VERIFY_PARAMETER_NAME_FAILED);
+            return result;
+        }
+        
         String nameSuffix = fileSuffix.trim();
         String resourceViewSuffixs = FileUtils.getResourceViewSuffixs();
         if (StringUtils.isNotEmpty(resourceViewSuffixs)) {

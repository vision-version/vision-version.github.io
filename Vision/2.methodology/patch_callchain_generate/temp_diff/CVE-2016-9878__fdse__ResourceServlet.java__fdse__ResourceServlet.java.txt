diff --git a/./github_diff/CVE-2016-9878/oldfiles/ResourceServlet.java b/./github_diff/CVE-2016-9878/newfiles/ResourceServlet.java
index bd2c504..edfb2a6 100644
--- a/./github_diff/CVE-2016-9878/oldfiles/ResourceServlet.java
+++ b/./github_diff/CVE-2016-9878/newfiles/ResourceServlet.java
@@ -103,15 +103,16 @@ public class ResourceServlet extends HttpServletBean {
 		
 		String[] resourceUrls = StringUtils.tokenizeToStringArray(resourceUrl, RESOURCE_URL_DELIMITERS);
 		for (String url : resourceUrls) {
-			 if (this.allowedResources != null && !this.pathMatcher.match(this.allowedResources, url)) {
-				throw new ServletException("Resource [" + url + "] does not match allowed pattern [" + this.allowedResources + "]");
+			String path = StringUtils.cleanPath(url);
+			 if (this.allowedResources != null && !this.pathMatcher.match(this.allowedResources, path)) {
+				throw new ServletException("Resource [" + path + "] does not match allowed pattern [" + this.allowedResources + "]");
 			}
 			
 			if (logger.isDebugEnabled()) {
-				logger.debug("Including resource [" + url + "]");
+				logger.debug("Including resource [" + path + "]");
 			}
 			
-			RequestDispatcher rd = request.getRequestDispatcher(url);
+			RequestDispatcher rd = request.getRequestDispatcher(path);
 			rd.include(request, response);
 		}
 		

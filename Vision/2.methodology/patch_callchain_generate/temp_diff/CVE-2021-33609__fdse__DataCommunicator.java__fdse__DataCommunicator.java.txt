diff --git a/./github_diff/CVE-2021-33609/oldfiles/DataCommunicator.java b/./github_diff/CVE-2021-33609/newfiles/DataCommunicator.java
index ad4d961..63d94ad 100644
--- a/./github_diff/CVE-2021-33609/oldfiles/DataCommunicator.java
+++ b/./github_diff/CVE-2021-33609/newfiles/DataCommunicator.java
@@ -29,6 +29,7 @@ import elemental.json.JsonArray;
 import elemental.json.JsonObject;
 public class DataCommunicator<T> extends AbstractExtension {
     private Registration dataProviderUpdateRegistration;
+    private static final int MAXIMUM_ALLOWED_ROWS = 500;
     protected class SimpleDataRequestRpc implements DataRequestRpc {
         @Override
         public void requestRows(int firstRowIndex, int numberOfRows, int firstCachedRowIndex, int cacheSize) {
@@ -147,10 +148,18 @@ public class DataCommunicator<T> extends AbstractExtension {
     }
     
     protected void onRequestRows(int firstRowIndex, int numberOfRows, int firstCachedRowIndex, int cacheSize) {
+        if (numberOfRows > getMaximumAllowedRows()) {
+            throw new IllegalStateException( "Client tried fetch more rows than allowed. This is denied to prevent denial of service.");
+        }
+        
         setPushRows(Range.withLength(firstRowIndex, numberOfRows));
         markAsDirty();
     }
     
+    protected int getMaximumAllowedRows() {
+        return MAXIMUM_ALLOWED_ROWS;
+    }
+        
     protected void onDropRows(JsonArray keys) {
         for (int i = 0; i < keys.length(); ++i) {
             handler.dropActiveData(keys.getString(i));

diff --git a/./github_diff/CVE-2021-22095/oldfiles/Message.java b/./github_diff/CVE-2021-22095/newfiles/Message.java
index 0e68c19..bba852e 100644
--- a/./github_diff/CVE-2021-22095/oldfiles/Message.java
+++ b/./github_diff/CVE-2021-22095/newfiles/Message.java
@@ -6,7 +6,9 @@ import org.springframework.util.Assert;
 public class Message implements Serializable {
 	private static final long serialVersionUID = -7177590352110605597L;
 	private static final String DEFAULT_ENCODING = Charset.defaultCharset().name();
+	private static final int DEFAULT_MAX_BODY_LENGTH = 50;
 	private static String bodyEncoding = DEFAULT_ENCODING;
+	private static int maxBodyLength = DEFAULT_MAX_BODY_LENGTH;
 	private final MessageProperties messageProperties;
 	private final byte[] body;
 	 public Message(byte[] body) {
@@ -29,6 +31,10 @@ public class Message implements Serializable {
 		bodyEncoding = encoding;
 	}
 	
+	 public static void setMaxBodyLength(int length) {
+		maxBodyLength = length;
+	}
+	
 	public byte[] getBody() {
 		return this.body; 
 	}
@@ -60,7 +66,7 @@ public class Message implements Serializable {
 			}
 			
 			String encoding = encoding(nullProps);
-			if (MessageProperties.CONTENT_TYPE_TEXT_PLAIN.equals(contentType) || MessageProperties.CONTENT_TYPE_JSON.equals(contentType) || MessageProperties.CONTENT_TYPE_JSON_ALT.equals(contentType) || MessageProperties.CONTENT_TYPE_XML.equals(contentType)) {
+			if (this.body.length <= maxBodyLength && (MessageProperties.CONTENT_TYPE_TEXT_PLAIN.equals(contentType) || MessageProperties.CONTENT_TYPE_JSON.equals(contentType) || MessageProperties.CONTENT_TYPE_JSON_ALT.equals(contentType) || MessageProperties.CONTENT_TYPE_XML.equals(contentType))) {
 				return new String(this.body, encoding);
 			}
 			

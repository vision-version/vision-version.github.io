diff --git a/./github_diff/CVE-2013-2055/oldfiles/PackageResourceGuard.java b/./github_diff/CVE-2013-2055/newfiles/PackageResourceGuard.java
index 62f641f..3c0780a 100644
--- a/./github_diff/CVE-2013-2055/oldfiles/PackageResourceGuard.java
+++ b/./github_diff/CVE-2013-2055/newfiles/PackageResourceGuard.java
@@ -35,11 +35,25 @@ public class PackageResourceGuard implements IPackageResourceGuard {
 			ext = path.substring(ixExtension + 1).toLowerCase().trim();
 		}
 		
-		if ("html".equals(ext) && getClass().getClassLoader().getResource(path.replaceAll("\\.html", ".class")) != null){
+		if ("html".equals(ext)){
+			String prefix = path.substring(0, ixExtension);
+			ClassLoader classLoader = getClass().getClassLoader();
+			while (true){
+				if (classLoader.getResource(prefix + ".class") != null){
 					log.warn("Access denied to shared (static) resource because it is a Wicket markup file: " + path);
 					return false;
 				}
 				
+				int ixUnderscore = prefix.lastIndexOf('_');
+				if (ixUnderscore == -1){
+					break;
+				}
+				
+				prefix = prefix.substring(0, ixUnderscore);
+			}
+			
+		}
+		
 		if (acceptExtension(ext) == false){
 			log.warn("Access denied to shared (static) resource because of the file extension: " + path);
 			return false;

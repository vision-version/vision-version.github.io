diff --git a/./github_diff/CVE-2020-5408/oldfiles/BCryptPasswordEncoder.java b/./github_diff/CVE-2020-5408/newfiles/BCryptPasswordEncoder.java
index 6121587..7a4f269 100644
--- a/./github_diff/CVE-2020-5408/oldfiles/BCryptPasswordEncoder.java
+++ b/./github_diff/CVE-2020-5408/newfiles/BCryptPasswordEncoder.java
@@ -46,6 +46,10 @@ public class BCryptPasswordEncoder implements PasswordEncoder {
 	}
 	
 	public String encode(CharSequence rawPassword) {
+		if (rawPassword == null) {
+			throw new IllegalArgumentException("rawPassword cannot be null");
+		}
+		
 		String salt;
 		if (random != null) {
 			salt = BCrypt.gensalt(version.getVersion(), strength, random);
@@ -58,6 +62,10 @@ public class BCryptPasswordEncoder implements PasswordEncoder {
 	}
 	
 	public boolean matches(CharSequence rawPassword, String encodedPassword) {
+		if (rawPassword == null) {
+			throw new IllegalArgumentException("rawPassword cannot be null");
+		}
+		
 		if (encodedPassword == null || encodedPassword.length() == 0) {
 			logger.warn("Empty encoded password");
 			return false;

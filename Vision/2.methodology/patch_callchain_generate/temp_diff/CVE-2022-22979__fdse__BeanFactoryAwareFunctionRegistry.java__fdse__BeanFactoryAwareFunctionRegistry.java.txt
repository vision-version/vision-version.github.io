diff --git a/./github_diff/CVE-2022-22979/oldfiles/BeanFactoryAwareFunctionRegistry.java b/./github_diff/CVE-2022-22979/newfiles/BeanFactoryAwareFunctionRegistry.java
index 7707c52..347547c 100644
--- a/./github_diff/CVE-2022-22979/oldfiles/BeanFactoryAwareFunctionRegistry.java
+++ b/./github_diff/CVE-2022-22979/newfiles/BeanFactoryAwareFunctionRegistry.java
@@ -69,6 +69,8 @@ public class BeanFactoryAwareFunctionRegistry extends SimpleFunctionRegistry imp
 		}
 		
 		FunctionInvocationWrapper function = this.doLookup(type, functionDefinition, expectedOutputMimeTypes);
+		Object syncInstance = functionDefinition == null ? this : functionDefinition;
+		synchronized (syncInstance) {
 			if (function == null) {
 				Set<String> functionRegistratioinNames = super.getNames(null);
 				String[] functionNames = StringUtils.delimitedListToStringArray(functionDefinition.replaceAll(",", "|").trim(), "|");
@@ -124,6 +126,8 @@ public class BeanFactoryAwareFunctionRegistry extends SimpleFunctionRegistry imp
 				function = super.doLookup(type, functionDefinition, expectedOutputMimeTypes);
 			}
 			
+		}
+		
 		return (T) function;
 	}
 	

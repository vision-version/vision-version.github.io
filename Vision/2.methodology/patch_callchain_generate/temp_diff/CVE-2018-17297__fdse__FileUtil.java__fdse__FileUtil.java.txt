diff --git a/./github_diff/CVE-2018-17297/oldfiles/FileUtil.java b/./github_diff/CVE-2018-17297/newfiles/FileUtil.java
index c7495ee..5951960 100644
--- a/./github_diff/CVE-2018-17297/oldfiles/FileUtil.java
+++ b/./github_diff/CVE-2018-17297/newfiles/FileUtil.java
@@ -222,11 +222,7 @@ import cn.hutool.core.util.URLUtil;
 	}
 	
  public static File file(String parent, String path) {
-		if (StrUtil.isBlank(path)) {
-			throw new NullPointerException("File path is blank!");
-		}
-		
-		return new File(parent, path);
+		return file(new File(parent), path);
 	}
 	
  public static File file(File parent, String path) {
@@ -234,7 +230,9 @@ import cn.hutool.core.util.URLUtil;
 			throw new NullPointerException("File path is blank!");
 		}
 		
-		return new File(parent, path);
+		final File file = new File(parent, path);
+		checkSlip(parent, file);
+		return file;
 	}
 	
  public static File file(File directory, String... names) {
@@ -246,7 +244,7 @@ import cn.hutool.core.util.URLUtil;
  File file = directory;
 		for (String name : names) {
 			if (null != name) {
-				file = new File(file, name);
+				file = file(file, name);
 			}
 			
 		}
@@ -262,10 +260,10 @@ import cn.hutool.core.util.URLUtil;
  File file = null;
 		for (String name : names) {
 			if (file == null) {
-				file = new File(name);
+				file = file(name);
 			}
 			 else {
-				file = new File(file, name);
+				file = file(file, name);
 			}
 			
 		}
@@ -1597,5 +1595,22 @@ import cn.hutool.core.util.URLUtil;
 		return getParent(parentFile, level - 1);
 	}
 	
+	 public static void checkSlip(File parentFile, File file) throws IllegalArgumentException {
+		String parentCanonicalPath;
+		String canonicalPath;
+		try {
+			parentCanonicalPath = parentFile.getCanonicalPath();
+			canonicalPath = file.getCanonicalPath();
+		}
+		 catch (IOException e) {
+			throw new IORuntimeException(e);
+		}
+		
+		if (false == canonicalPath.startsWith(parentCanonicalPath)) {
+			throw new IllegalArgumentException("New file is outside of the parent dir: " + file.getName());
+		}
+		
+	}
+	
 }
 

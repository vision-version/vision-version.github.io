diff --git a/./github_diff/CVE-2019-12402/oldfiles/NioZipEncoding.java b/./github_diff/CVE-2019-12402/newfiles/NioZipEncoding.java
index fbee421..0704098 100644
--- a/./github_diff/CVE-2019-12402/oldfiles/NioZipEncoding.java
+++ b/./github_diff/CVE-2019-12402/newfiles/NioZipEncoding.java
@@ -63,6 +63,9 @@ class NioZipEncoding implements ZipEncoding, CharsetAccessor {
                 int increment = estimateIncrementalEncodingSize(enc, cb.remaining());
                 out = ZipEncodingHelper.growBufferBy(out, increment);
             }
+             else if (res.isUnderflow() || res.isError()) {
+                break;
+            }
             
         }
         

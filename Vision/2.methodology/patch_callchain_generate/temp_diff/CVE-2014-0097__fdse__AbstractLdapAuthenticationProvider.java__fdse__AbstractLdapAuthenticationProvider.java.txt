diff --git a/./github_diff/CVE-2014-0097/oldfiles/AbstractLdapAuthenticationProvider.java b/./github_diff/CVE-2014-0097/newfiles/AbstractLdapAuthenticationProvider.java
index 186f09a..5ae977b 100644
--- a/./github_diff/CVE-2014-0097/oldfiles/AbstractLdapAuthenticationProvider.java
+++ b/./github_diff/CVE-2014-0097/newfiles/AbstractLdapAuthenticationProvider.java
@@ -39,6 +39,10 @@ public abstract class AbstractLdapAuthenticationProvider implements Authenticati
             throw new BadCredentialsException(messages.getMessage("LdapAuthenticationProvider.emptyUsername", "Empty Username"));
         }
         
+        if (!StringUtils.hasLength(password)) {
+            throw new BadCredentialsException(messages.getMessage("AbstractLdapAuthenticationProvider.emptyPassword", "Empty Password"));
+        }
+        
         Assert.notNull(password, "Null password was supplied in authentication token");
         DirContextOperations userData = doAuthentication(userToken);
         UserDetails user = userDetailsContextMapper.mapUserFromContext(userData, authentication.getName(), loadUserAuthorities(userData, authentication.getName(), (String)authentication.getCredentials()));

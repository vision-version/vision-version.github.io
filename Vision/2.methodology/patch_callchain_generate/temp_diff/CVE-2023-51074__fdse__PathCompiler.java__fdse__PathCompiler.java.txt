diff --git a/./github_diff/CVE-2023-51074/oldfiles/PathCompiler.java b/./github_diff/CVE-2023-51074/newfiles/PathCompiler.java
index 25f635a..e852bff 100644
--- a/./github_diff/CVE-2023-51074/oldfiles/PathCompiler.java
+++ b/./github_diff/CVE-2023-51074/newfiles/PathCompiler.java
@@ -597,7 +597,11 @@ public class PathCompiler {
             fail("Property has not been closed - missing closing " + potentialStringDelimiter);
         }
 
-        int endBracketIndex = path.indexOfNextSignificantChar(endPosition, CLOSE_SQUARE_BRACKET) + 1;
+        int endBracketIndex = path.indexOfNextSignificantChar(endPosition, CLOSE_SQUARE_BRACKET);
+        if(endBracketIndex == -1) {
+            fail("Property has not been closed - missing closing ]");
+        }
+        endBracketIndex++;
 
         path.setPosition(endBracketIndex);
 

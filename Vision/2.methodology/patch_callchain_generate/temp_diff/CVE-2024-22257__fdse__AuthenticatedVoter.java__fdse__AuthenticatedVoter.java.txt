diff --git a/./github_diff/CVE-2024-22257/oldfiles/AuthenticatedVoter.java b/./github_diff/CVE-2024-22257/newfiles/AuthenticatedVoter.java
index b7338eb..bbb4ce9 100644
--- a/./github_diff/CVE-2024-22257/oldfiles/AuthenticatedVoter.java
+++ b/./github_diff/CVE-2024-22257/newfiles/AuthenticatedVoter.java
@@ -12,7 +12,7 @@ public class AuthenticatedVoter implements AccessDecisionVoter<Object> {
 	public static final String IS_AUTHENTICATED_ANONYMOUSLY = "IS_AUTHENTICATED_ANONYMOUSLY";
 	private AuthenticationTrustResolver authenticationTrustResolver = new AuthenticationTrustResolverImpl();
 	private boolean isFullyAuthenticated(Authentication authentication) {
-		return (!this.authenticationTrustResolver.isAnonymous(authentication) && !this.authenticationTrustResolver.isRememberMe(authentication));
+		return authentication != null && (!this.authenticationTrustResolver.isAnonymous(authentication) && !this.authenticationTrustResolver.isRememberMe(authentication));
 	}
 	
 	public void setAuthenticationTrustResolver(AuthenticationTrustResolver authenticationTrustResolver) {

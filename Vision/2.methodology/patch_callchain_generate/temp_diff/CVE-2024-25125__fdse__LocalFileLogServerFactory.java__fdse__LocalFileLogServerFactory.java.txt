diff --git a/./github_diff/CVE-2024-25125/oldfiles/LocalFileLogServerFactory.java b/./github_diff/CVE-2024-25125/newfiles/LocalFileLogServerFactory.java
index c90eb1d..d521d27 100644
--- a/./github_diff/CVE-2024-25125/oldfiles/LocalFileLogServerFactory.java
+++ b/./github_diff/CVE-2024-25125/newfiles/LocalFileLogServerFactory.java
@@ -1,4 +1,5 @@
 package io.digdag.core.log;
+import java.nio.file.NoSuchFileException;
 import java.util.concurrent.locks.ReentrantReadWriteLock;
 import java.io.InputStream;
 import java.io.OutputStream;
@@ -105,12 +106,17 @@ public class LocalFileLogServerFactory implements LogServerFactory {
         
         @Override
         protected byte[] getFile(String dateDir, String attemptDir, String fileName) throws StorageFileNotFoundException {
-            Path path = getPrefixDir(dateDir, attemptDir).resolve(fileName);
+            Path prefixDir = getPrefixDir(dateDir, attemptDir);
+            Path path = prefixDir.resolve(fileName).normalize();
+            if (!path.startsWith(prefixDir)) {
+                throw new IllegalArgumentException("Invalid file name: " + fileName);
+            }
+            
             try (InputStream in = Files.newInputStream(path)) {
                 return ByteStreams.toByteArray(in);
             }
             
-            catch (FileNotFoundException ex) {
+            catch (FileNotFoundException | NoSuchFileException ex) {
                 throw new StorageFileNotFoundException(ex);
             }
             

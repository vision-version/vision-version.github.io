diff --git a/./github_diff/CVE-2018-11771/oldfiles/ZipArchiveInputStream.java b/./github_diff/CVE-2018-11771/newfiles/ZipArchiveInputStream.java
index cf13bc5..13aa339 100644
--- a/./github_diff/CVE-2018-11771/oldfiles/ZipArchiveInputStream.java
+++ b/./github_diff/CVE-2018-11771/newfiles/ZipArchiveInputStream.java
@@ -328,7 +328,8 @@ public class ZipArchiveInputStream extends ArchiveInputStream implements InputSt
             buf.position(0);
             final int l = in.read(buf.array());
             if (l == -1) {
-                return -1;
+                buf.limit(0);
+                throw new IOException("Truncated ZIP file");
             }
             
             buf.limit(l);

diff --git a/./github_diff/CVE-2018-20000/oldfiles/PostRequestPars.java b/./github_diff/CVE-2018-20000/newfiles/PostRequestPars.java
index ca6aa9e..3f1e92c 100644
--- a/./github_diff/CVE-2018-20000/oldfiles/PostRequestPars.java
+++ b/./github_diff/CVE-2018-20000/newfiles/PostRequestPars.java
@@ -1,16 +1,11 @@
 package org.bedework.webdav.servlet.common;
 import org.bedework.util.misc.Util;
-import org.bedework.webdav.servlet.shared.WebdavBadRequest;
 import org.bedework.webdav.servlet.shared.WebdavException;
 import org.bedework.webdav.servlet.shared.WebdavNsIntf;
 import org.w3c.dom.Document;
-import org.xml.sax.InputSource;
-import org.xml.sax.SAXException;
 import java.io.Reader;
 import javax.servlet.http.HttpServletRequest;
-import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
-public class PostRequestPars {
+public class PostRequestPars implements SecureXml {
   private final HttpServletRequest req;
   private final WebdavNsIntf intf;
   private final String method;
@@ -68,7 +63,7 @@ public class PostRequestPars {
       throw new WebdavException(t);
     }
     
-    xmlDoc = parseXml(reqRdr);
+    xmlDoc = parseXmlSafely(req.getContentLength(), reqRdr);
     getTheReader = false;
     return true;
   }
@@ -128,26 +123,6 @@ public class PostRequestPars {
     return addMember;
   }
   
-  private Document parseXml(final Reader rdr) throws WebdavException{
-    if (rdr == null) {
-      return null;
-    }
-    
-    try {
-      final DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
-      factory.setNamespaceAware(true);
-      final DocumentBuilder builder = factory.newDocumentBuilder();
-      return builder.parse(new InputSource(rdr));
-    }
-     catch (final SAXException e) {
-      throw new WebdavBadRequest();
-    }
-     catch (final Throwable t) {
-      throw new WebdavException(t);
-    }
-    
-  }
-  
   public boolean isAppXml() {
     return contentTypePars != null && (contentTypePars[0].equals("application/xml") || contentTypePars[0].equals("text/xml"));
   }

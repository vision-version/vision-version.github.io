diff --git a/./github_diff/CVE-2020-15250/oldfiles/TemporaryFolder.java b/./github_diff/CVE-2020-15250/newfiles/TemporaryFolder.java
index c6dab39..fe859cc 100644
--- a/./github_diff/CVE-2020-15250/oldfiles/TemporaryFolder.java
+++ b/./github_diff/CVE-2020-15250/newfiles/TemporaryFolder.java
@@ -2,6 +2,9 @@ package org.junit.rules;
 import static org.junit.Assert.fail;
 import java.io.File;
 import java.io.IOException;
+import java.lang.reflect.Array;
+import java.lang.reflect.InvocationTargetException;
+import java.lang.reflect.Method;
 import org.junit.Rule;
 public class TemporaryFolder extends ExternalResource {
     private final File parentFolder;
@@ -121,7 +124,52 @@ public class TemporaryFolder extends ExternalResource {
         return createTemporaryFolderIn(getRoot());
     }
     
-    private File createTemporaryFolderIn(File parentFolder) throws IOException {
+    private static File createTemporaryFolderIn(File parentFolder) throws IOException {
+        try {
+            return createTemporaryFolderWithNioApi(parentFolder);
+        }
+         catch (ClassNotFoundException ignore) {
+            return createTemporaryFolderWithFileApi(parentFolder);
+        }
+         catch (InvocationTargetException e) {
+            Throwable cause = e.getCause();
+            if (cause instanceof IOException) {
+                throw (IOException) cause;
+            }
+            
+            if (cause instanceof RuntimeException) {
+                throw (RuntimeException) cause;
+            }
+            
+            IOException exception = new IOException("Failed to create temporary folder in " + parentFolder);
+            exception.initCause(cause);
+            throw exception;
+        }
+         catch (Exception e) {
+            throw new RuntimeException("Failed to create temporary folder in " + parentFolder, e);
+        }
+        
+    }
+    
+    private static File createTemporaryFolderWithNioApi(File parentFolder) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException {
+        Class<?> filesClass = Class.forName("java.nio.file.Files");
+        Object fileAttributeArray = Array.newInstance(Class.forName("java.nio.file.attribute.FileAttribute"), 0);
+        Class<?> pathClass = Class.forName("java.nio.file.Path");
+        Object tempDir;
+        if (parentFolder != null) {
+            Method createTempDirectoryMethod = filesClass.getDeclaredMethod("createTempDirectory", pathClass, String.class, fileAttributeArray.getClass());
+            Object parentPath = File.class.getDeclaredMethod("toPath").invoke(parentFolder);
+            tempDir = createTempDirectoryMethod.invoke(null, parentPath, TMP_PREFIX, fileAttributeArray);
+        }
+         else {
+            Method createTempDirectoryMethod = filesClass.getDeclaredMethod("createTempDirectory", String.class, fileAttributeArray.getClass());
+            tempDir = createTempDirectoryMethod.invoke(null, TMP_PREFIX, fileAttributeArray);
+        }
+        
+        return (File) pathClass.getDeclaredMethod("toFile").invoke(tempDir);
+    }
+    
+    private static File createTemporaryFolderWithFileApi(File parentFolder) throws IOException {
         File createdFolder = null;
         for (int i = 0; i < TEMP_DIR_ATTEMPTS; ++i) {
             String suffix = ".tmp";

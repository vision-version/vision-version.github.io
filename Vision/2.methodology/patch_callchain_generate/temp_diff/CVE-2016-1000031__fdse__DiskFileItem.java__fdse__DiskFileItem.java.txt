diff --git a/./github_diff/CVE-2016-1000031/oldfiles/DiskFileItem.java b/./github_diff/CVE-2016-1000031/newfiles/DiskFileItem.java
index 19da08e..69e5c28 100644
--- a/./github_diff/CVE-2016-1000031/oldfiles/DiskFileItem.java
+++ b/./github_diff/CVE-2016-1000031/newfiles/DiskFileItem.java
@@ -11,6 +11,7 @@ import java.io.InputStream;
 import java.io.ObjectInputStream;
 import java.io.ObjectOutputStream;
 import java.io.OutputStream;
+import java.io.Serializable;
 import java.io.UnsupportedEncodingException;
 import java.util.Map;
 import java.util.UUID;
@@ -23,6 +24,7 @@ import org.apache.commons.fileupload.util.Streams;
 import org.apache.commons.io.IOUtils;
 import org.apache.commons.io.output.DeferredFileOutputStream;
 public class DiskFileItem implements FileItem {
+	 public static final String SERIALIZABLE_PROPERTY = DiskFileItem.class.getName() + ".serializable";
 	 private static final long serialVersionUID = 2237570099615271025L;
     public static final String DEFAULT_CHARSET = "ISO-8859-1";
     private static final String UID = UUID.randomUUID().toString().replace('-', '_');
@@ -305,6 +307,10 @@ public class DiskFileItem implements FileItem {
     }
     
     private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
+    	if (!Boolean.getBoolean(SERIALIZABLE_PROPERTY)) {
+    		throw new IllegalStateException("Property " + SERIALIZABLE_PROPERTY + " is not true, rejecting to deserialize a DiskFileItem.");
+    	}
+    	
         in.defaultReadObject();
         if (repository != null) {
             if (repository.isDirectory()) {

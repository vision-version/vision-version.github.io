diff --git a/./github_diff/CVE-2018-20000/oldfiles/MethodBase.java b/./github_diff/CVE-2018-20000/newfiles/MethodBase.java
index d0d5941..1535d42 100644
--- a/./github_diff/CVE-2018-20000/oldfiles/MethodBase.java
+++ b/./github_diff/CVE-2018-20000/newfiles/MethodBase.java
@@ -31,7 +31,7 @@ import javax.xml.namespace.QName;
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 import javax.xml.ws.Holder;
-public abstract class MethodBase extends Logged {
+public abstract class MethodBase extends Logged implements SecureXml {
   protected boolean dumpContent;
   protected boolean hasBriefHeader;
   protected WebdavNsIntf nsIntf;
@@ -226,28 +226,8 @@ public abstract class MethodBase extends Logged {
     
   }
   
-  protected Document parseContent(final int len, final Reader rdr) throws WebdavException{
-    if (len == 0) {
-      return null;
-    }
-    
-    if (rdr == null) {
-      return null;
-    }
-    
-    try {
-      DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
-      factory.setNamespaceAware(true);
-      DocumentBuilder builder = factory.newDocumentBuilder();
-      return builder.parse(new InputSource(rdr));
-    }
-     catch (SAXException e) {
-      throw new WebdavBadRequest();
-    }
-     catch (Throwable t) {
-      throw new WebdavException(t);
-    }
-    
+  protected Document parseContent(final int contentLength, final Reader reader) throws WebdavException{
+    return parseXmlSafely(contentLength, reader);
   }
   
   protected String formatHTTPDate(final Timestamp val) {

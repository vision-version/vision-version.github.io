stringproperty=order.getproperty();booleanqualifyreference=!property.contains("(");for(stringjoinalias:joinaliases)if(property.startswith(joinalias.concat(".")))qualifyreference=false;break;stringreference=qualifyreference&&stringutils.hastext(alias)?string.format("%s.%s",alias,property):property;stringwrapped=order.isignorecase()?string.format("lower(%s)",reference):reference;returnstring.format("%s%s",wrapped,tojpadirection(order));
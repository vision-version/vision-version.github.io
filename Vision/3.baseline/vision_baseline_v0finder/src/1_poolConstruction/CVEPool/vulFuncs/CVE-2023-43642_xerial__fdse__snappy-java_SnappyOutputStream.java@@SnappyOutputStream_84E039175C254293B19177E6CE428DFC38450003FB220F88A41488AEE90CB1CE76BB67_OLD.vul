this.out=out;this.blocksize=math.max(min_block_size,blocksize);intinputsize=blocksize;intoutputsize=snappycodec.header_size+4+snappy.maxcompressedlength(blocksize);this.inputbufferallocator=bufferallocatorfactory.getbufferallocator(inputsize);this.outputbufferallocator=bufferallocatorfactory.getbufferallocator(outputsize);inputbuffer=inputbufferallocator.allocate(inputsize);outputbuffer=outputbufferallocator.allocate(outputsize);
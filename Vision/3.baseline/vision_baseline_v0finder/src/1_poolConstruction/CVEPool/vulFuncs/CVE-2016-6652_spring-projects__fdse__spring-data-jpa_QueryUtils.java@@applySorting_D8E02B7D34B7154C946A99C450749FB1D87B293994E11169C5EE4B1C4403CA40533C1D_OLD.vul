assert.hastext(query);if(null==sort||!sort.iterator().hasnext())returnquery;stringbuilderbuilder=newstringbuilder(query);if(!order_by.matcher(query).matches())builder.append("orderby");elsebuilder.append(",");set<string>aliases=getouterjoinaliases(query);for(orderorder:sort)builder.append(getorderclause(aliases,alias,order)).append(",");builder.delete(builder.length()-2,builder.length());returnbuilder.tostring();
result<object>result=checkresourceuploadstartupstate();if(!result.getcode().equals(status.success.getcode()))returnresult;stringfullname=currentdir.equals("/")?string.format("%s%s",currentdir,name):string.format("%s/%s",currentdir,name);result=verifyresource(loginuser,type,fullname,pid);if(!result.getcode().equals(status.success.getcode()))returnresult;if(checkresourceexists(fullname,0,type.ordinal()))logger.error("resourcedirectoryhasexist,can'trecreate",fullname);putmsg(result,status.resource_exist);returnresult;datenow=newdate();resourceresource=newresource(pid,name,fullname,true,description,name,loginuser.getid(),type,0,now,now);tryresourcesmapper.insert(resource);putmsg(result,status.success);map<object,object>datamap=newbeanmap(resource);map<string,object>resultmap=newhashmap<>();for(map.entry<object,object>entry:datamap.entryset())if(!"class".equalsignorecase(entry.getkey().tostring()))resultmap.put(entry.getkey().tostring(),entry.getvalue());result.setdata(resultmap);catch(duplicatekeyexceptione)logger.error("resourcedirectoryhasexist,can'trecreate",fullname);putmsg(result,status.resource_exist);returnresult;catch(exceptione)logger.error("resourcealreadyexists,can'trecreate",e);thrownewserviceexception("resourcealreadyexists,can'trecreate");createdirectory(loginuser,fullname,type,result);returnresult;
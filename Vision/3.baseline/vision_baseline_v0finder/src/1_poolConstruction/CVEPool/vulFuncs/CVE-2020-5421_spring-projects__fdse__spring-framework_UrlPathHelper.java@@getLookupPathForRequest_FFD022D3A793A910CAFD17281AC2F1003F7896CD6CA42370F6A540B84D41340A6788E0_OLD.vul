stringpathwithinapp=getpathwithinapplication(request);if(this.alwaysusefullpath)returnpathwithinapp;stringrest=getpathwithinservletmapping(request,pathwithinapp);if(stringutils.haslength(rest))returnrest;elsereturnpathwithinapp;
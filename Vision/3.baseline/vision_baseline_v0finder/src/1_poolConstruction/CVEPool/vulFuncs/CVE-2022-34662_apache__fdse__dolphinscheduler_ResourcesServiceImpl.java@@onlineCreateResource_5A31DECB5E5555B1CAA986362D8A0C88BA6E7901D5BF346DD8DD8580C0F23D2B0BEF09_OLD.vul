result<object>result=checkresourceuploadstartupstate();if(!result.getcode().equals(status.success.getcode()))returnresult;stringnamesuffix=filesuffix.trim();stringresourceviewsuffixs=fileutils.getresourceviewsuffixs();if(stringutils.isnotempty(resourceviewsuffixs))list<string>strlist=arrays.aslist(resourceviewsuffixs.split(","));if(!strlist.contains(namesuffix))logger.error("resourcesuffixnotsupportcreate",namesuffix);putmsg(result,status.resource_suffix_not_support_view);returnresult;stringname=filename.trim()+"."+namesuffix;stringfullname=currentdir.equals("/")?string.format("%s%s",currentdir,name):string.format("%s/%s",currentdir,name);result=verifyresource(loginuser,type,fullname,pid);if(!result.getcode().equals(status.success.getcode()))returnresult;datenow=newdate();resourceresource=newresource(pid,name,fullname,false,desc,name,loginuser.getid(),type,content.getbytes().length,now,now);resourcesmapper.insert(resource);updateparentresourcesize(resource,resource.getsize());putmsg(result,status.success);map<object,object>datamap=newbeanmap(resource);map<string,object>resultmap=newhashmap<>();for(map.entry<object,object>entry:datamap.entryset())if(!constants.class.equalsignorecase(entry.getkey().tostring()))resultmap.put(entry.getkey().tostring(),entry.getvalue());result.setdata(resultmap);stringtenantcode=tenantmapper.querybyid(loginuser.gettenantid()).gettenantcode();result=uploadcontenttohdfs(fullname,tenantcode,content);if(!result.getcode().equals(status.success.getcode()))thrownewserviceexception(result.getmsg());returnresult;
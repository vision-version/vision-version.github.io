finalmap<string,string>urlparameters=newhashmap<string,string>();logger.debug("placingurlparametersinmap.");urlparameters.put("ticket",ticket);urlparameters.put("service",encodeurl(serviceurl));if(this.renew)urlparameters.put("renew","true");logger.debug("callingtemplateurlattributemap.");populateurlattributemap(urlparameters);logger.debug("loadingcustomparametersfromconfiguration.");if(this.customparameters!=null)urlparameters.putall(this.customparameters);finalstringsuffix=geturlsuffix();finalstringbuilderbuffer=newstringbuilder(urlparameters.size()*10+this.casserverurlprefix.length()+suffix.length()+1);inti=0;buffer.append(this.casserverurlprefix);if(!this.casserverurlprefix.endswith("/"))buffer.append("/");buffer.append(suffix);for(map.entry<string,string>entry:urlparameters.entryset())finalstringkey=entry.getkey();finalstringvalue=entry.getvalue();if(value!=null)buffer.append(i++==0?"?":"&");buffer.append(key);buffer.append("=");buffer.append(value);returnbuffer.tostring();
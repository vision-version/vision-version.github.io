inttag=_in.read();if(tag==-1)returnnull;set00check(false);inttagno=asn1inputstream.readtagnumber(_in,tag);booleanisconstructed=(tag&bertags.constructed)!=0;intlength=asn1inputstream.readlength(_in,_limit,tagno==bertags.octet_string||tagno==bertags.sequence||tagno==bertags.set||tagno==bertags.external);if(length<0)if(!isconstructed)thrownewioexception("indefinite-lengthprimitiveencodingencountered");indefinitelengthinputstreamindin=newindefinitelengthinputstream(_in,_limit);asn1streamparsersp=newasn1streamparser(indin,_limit);if((tag&bertags.application)!=0)returnnewberapplicationspecificparser(tagno,sp);if((tag&bertags.tagged)!=0)returnnewbertaggedobjectparser(true,tagno,sp);returnsp.readindef(tagno);elsedefinitelengthinputstreamdefin=newdefinitelengthinputstream(_in,length);if((tag&bertags.application)!=0)returnnewdlapplicationspecific(isconstructed,tagno,defin.tobytearray());if((tag&bertags.tagged)!=0)returnnewbertaggedobjectparser(isconstructed,tagno,newasn1streamparser(defin));if(isconstructed)switch(tagno)casebertags.octet_string:returnnewberoctetstringparser(newasn1streamparser(defin));casebertags.sequence:returnnewdlsequenceparser(newasn1streamparser(defin));casebertags.set:returnnewdlsetparser(newasn1streamparser(defin));casebertags.external:returnnewderexternalparser(newasn1streamparser(defin));default:thrownewioexception("unknowntag"+tagno+"encountered");switch(tagno)casebertags.octet_string:returnnewderoctetstringparser(defin);tryreturnasn1inputstream.createprimitivederobject(tagno,defin,tmpbuffers);catch(illegalargumentexceptione)thrownewasn1exception("corruptedstreamdetected",e);
intixextension=path.lastindexof('.');intlen=path.length();finalstringext;if(ixextension<=0||ixextension==len||(path.lastindexof('/')+1)==ixextension)ext=null;elseext=path.substring(ixextension+1).tolowercase().trim();if("html".equals(ext)&&getclass().getclassloader().getresource(path.replaceall("\\.html",".class"))!=null)log.warn("accessdeniedtoshared(static)resourcebecauseitisawicketmarkupfile:"+path);returnfalse;if(acceptextension(ext)==false)log.warn("accessdeniedtoshared(static)resourcebecauseofthefileextension:"+path);returnfalse;stringfilename=strings.lastpathcomponent(path,'/');if(acceptfile(filename)==false)log.warn("accessdeniedtoshared(static)resourcebecauseofthefilename:"+path);returnfalse;if(strings.isempty(application.get().getresourcesettings().getparentfolderplaceholder()))if(path.contains(".."))log.warn("accesstoparentdirectoriesvia'..'isbydefaultdisabledforsharedresources:"+path);returnfalse;returntrue;
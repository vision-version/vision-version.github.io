if(key.getstatus()!=keystatustype.enabled)thrownewgeneralsecurityexception("onlyenabledkeyisallowed");entry<p>entry=newentry<p>(primitive,cryptoformat.getoutputprefix(key),key.getstatus(),key.getoutputprefixtype(),key.getkeyid());list<entry<p>>list=newarraylist<entry<p>>();list.add(entry);stringidentifier=newstring(entry.getidentifier(),utf_8);list<entry<p>>existing=primitives.put(identifier,collections.unmodifiablelist(list));if(existing!=null)list<entry<p>>newlist=newarraylist<entry<p>>();newlist.addall(existing);newlist.add(entry);primitives.put(identifier,collections.unmodifiablelist(newlist));returnentry;
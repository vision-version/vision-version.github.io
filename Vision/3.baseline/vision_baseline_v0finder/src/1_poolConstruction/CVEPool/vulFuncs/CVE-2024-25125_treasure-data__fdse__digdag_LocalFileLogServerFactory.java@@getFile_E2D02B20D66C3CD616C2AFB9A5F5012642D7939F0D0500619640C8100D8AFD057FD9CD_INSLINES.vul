            Path prefixDir = getPrefixDir(dateDir, attemptDir);
            Path path = prefixDir.resolve(fileName).normalize();
            if (!path.startsWith(prefixDir)) {
                throw new IllegalArgumentException("Invalid file name: " + fileName);
            }
            catch (FileNotFoundException | NoSuchFileException ex) {

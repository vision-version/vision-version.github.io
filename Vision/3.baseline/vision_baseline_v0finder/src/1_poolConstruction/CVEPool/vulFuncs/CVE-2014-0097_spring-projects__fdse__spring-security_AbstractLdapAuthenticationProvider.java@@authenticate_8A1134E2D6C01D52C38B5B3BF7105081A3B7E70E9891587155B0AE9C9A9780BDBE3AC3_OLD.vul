assert.isinstanceof(usernamepasswordauthenticationtoken.class,authentication,messages.getmessage("ldapauthenticationprovider.onlysupports","onlyusernamepasswordauthenticationtokenissupported"));finalusernamepasswordauthenticationtokenusertoken=(usernamepasswordauthenticationtoken)authentication;stringusername=usertoken.getname();stringpassword=(string)authentication.getcredentials();if(logger.isdebugenabled())logger.debug("processingauthenticationrequestforuser:"+username);if(!stringutils.haslength(username))thrownewbadcredentialsexception(messages.getmessage("ldapauthenticationprovider.emptyusername","emptyusername"));assert.notnull(password,"nullpasswordwassuppliedinauthenticationtoken");dircontextoperationsuserdata=doauthentication(usertoken);userdetailsuser=userdetailscontextmapper.mapuserfromcontext(userdata,authentication.getname(),loaduserauthorities(userdata,authentication.getname(),(string)authentication.getcredentials()));returncreatesuccessfulauthentication(usertoken,user);
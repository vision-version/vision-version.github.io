							final File tempDir = new File(workDirectory, message.getHeaders().getId().toString());
							tempDir.mkdirs(); //NOSONAR false positive
							final File destinationFile = new File(tempDir, zipEntryName);

							/* If we see the relative traversal string of ".." we need to make sure
							 * that the outputdir + name doesn't leave the outputdir.
							 */
							if (!destinationFile.getCanonicalPath().startsWith(workDirectory.getCanonicalPath())) {
								throw new ZipException("The file " + zipEntryName +
										" is trying to leave the target output directory of " + workDirectory);
							}

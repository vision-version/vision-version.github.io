assert.notnull(input,"inputstringshouldnotbenull");assert.notnull(charset,"charsetshouldnotbenull");if(standardcharsets.us_ascii.equals(charset))returninput;assert.istrue(utf_8.equals(charset)||iso_8859_1.equals(charset),"charsetshouldbeutf-8oriso-8859-1");byte[]source=input.getbytes(charset);intlen=source.length;stringbuildersb=newstringbuilder(len<<1);sb.append(charset.name());sb.append("''");for(byteb:source)if(isrfc5987attrchar(b))sb.append((char)b);elsesb.append('%');charhex1=character.touppercase(character.fordigit((b>>4)&0xf,16));charhex2=character.touppercase(character.fordigit(b&0xf,16));sb.append(hex1);sb.append(hex2);returnsb.tostring();
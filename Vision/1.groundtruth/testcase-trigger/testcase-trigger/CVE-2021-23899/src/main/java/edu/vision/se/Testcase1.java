package edu.vision.se;

import com.google.json.JsonSanitizer;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class Testcase1 {

    @Test(timeout = 60000)
    public void testXssPayload() {
        String input = "x</\\script>u\\u\\uu\ufffd\ufffd\\u7u\\u\\u\\u\uffvision<\\script>5+alert(1)//";
        String sanitize = JsonSanitizer.sanitize(input);
        validateReturnValue(sanitize);
    }

    public void validateReturnValue(String sanitize) {
        assertEquals(
                "\"x\\u003c/script>uuuu\uFFFD\uFFvision7uuuu\uFFvision\\u003cscript>5+alert(1)//\"",
                sanitize
        );
    }
}

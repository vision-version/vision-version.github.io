package edu.vision.se;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

import java.io.File;

import org.junit.Test;
import org.mockito.Mock;
import org.slf4j.Logger;
import org.xwiki.velocity.introspection.SecureIntrospector;

public class Testcase1 {
    @Mock
    private Logger logger;

    class CustomFile extends File {
        public CustomFile(String s) {
            super(s);
        }
    }

    @Test
    public void checkObjectExecutePermissionWithFile() {
        SecureIntrospector secureIntrospector = new SecureIntrospector(new String[] {}, new String[] {}, null);
        assertTrue(secureIntrospector.checkObjectExecutePermission(File.class, "toString"));
        assertFalse(secureIntrospector.checkObjectExecutePermission(File.class, "mkdir"));

        assertTrue(secureIntrospector.checkObjectExecutePermission(File.class, "tostring"));
        assertFalse(secureIntrospector.checkObjectExecutePermission(File.class, "renameto"));
        assertFalse(secureIntrospector.checkObjectExecutePermission(File.class, "renameTo"));

        assertTrue(secureIntrospector.checkObjectExecutePermission(CustomFile.class, "toString"));
        assertFalse(secureIntrospector.checkObjectExecutePermission(CustomFile.class, "mkdir"));
    }

}
package edu.vision.se;


import org.jboss.netty.handler.codec.http.Cookie;
import org.jboss.netty.handler.codec.http.CookieDecoder;
import org.junit.Test;

import java.util.Iterator;
import java.util.Set;

import static org.junit.Assert.*;

public class Testcase2 {

    @Test(timeout = 60000)
    public void testDecodingCommaSeparatedClientSideCookies() {
        String source =
                "$Version=\"1\"; session_id=\"1234\", " +
                        "$Version=\"1\"; session_id=\"1111\"; $Domain=\".cracker.edu\"";

        Set<Cookie> cookies = new CookieDecoder().decode(source);
        validateReturnValue(cookies);
    }

    public void validateReturnValue(Set<Cookie> cookies) {
        Iterator<Cookie> it = cookies.iterator();
        Cookie c;

        assertTrue(it.hasNext());
        c = it.next();
        assertEquals(Integer.MIN_VALUE, c.getMaxAge());

        assertTrue(it.hasNext());
        c = it.next();
        assertEquals(Integer.MIN_VALUE, c.getMaxAge());

        assertFalse(it.hasNext());
    }

}
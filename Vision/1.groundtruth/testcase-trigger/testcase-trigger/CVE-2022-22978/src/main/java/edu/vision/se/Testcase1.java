package edu.vision.se;

import org.junit.Test;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.web.util.matcher.RegexRequestMatcher;

import static org.assertj.core.api.Assertions.assertThat;

public class Testcase1 {

    @Test
    public void matchesWithCarriageReturn() {
        RegexRequestMatcher matcher = new RegexRequestMatcher(".*", null);
        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/blah%0a");
        request.setServletPath("/blah\n");
        assertThat(matcher.matches(request)).isTrue();
    }

    @Test
    public void matchesWithLineFeed() {
        RegexRequestMatcher matcher = new RegexRequestMatcher(".*", null);
        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/blah%0d");
        request.setServletPath("/blah\r");
        assertThat(matcher.matches(request)).isTrue();
    }

}
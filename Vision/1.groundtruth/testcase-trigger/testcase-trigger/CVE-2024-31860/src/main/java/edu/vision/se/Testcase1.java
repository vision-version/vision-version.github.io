package edu.vision.se;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

import org.apache.zeppelin.service.NotebookService;
import org.junit.Test;

public class Testcase1 {

    @Test
    public void testNormalizeNotePath() throws NoSuchMethodException, SecurityException {
        NotebookService notebookService = new NotebookService(null, null, null, null);
        Method method = notebookService.getClass().getDeclaredMethod("normalizeNotePath", String.class);
        method.setAccessible(true);
        try {
            method.invoke(notebookService, "%2e%2e/%2e%2e/tmp/test222");
            fail("Should fail");
        } catch (InvocationTargetException e) {
            validateThrow(e);
        } catch (Exception e) {
        }
        try {
            method.invoke(notebookService, "./");
            fail("Should fail");
        } catch (InvocationTargetException e) {
            validateThrow(e);
        } catch (Exception e) {
        }
    }

    public void validateThrow(Throwable e) {
        assertTrue(e.getCause().getMessage().startsWith("Note name can not contain '..'")
                || e.getCause().getMessage().startsWith("Note name shouldn't end with '/'"));
    }
}
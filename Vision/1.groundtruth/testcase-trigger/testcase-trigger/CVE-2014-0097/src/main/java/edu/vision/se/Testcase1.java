package edu.vision.se;

import org.junit.Before;
import org.junit.Test;
import org.springframework.security.authentication.BadCredentialsException;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider;

public class Testcase1 {

    ActiveDirectoryLdapAuthenticationProvider provider;

    @Before
    public void setUp() throws Exception {
        provider = new ActiveDirectoryLdapAuthenticationProvider("mydomain.eu", "ldap://192.168.1.200/");
    }

    @Test(expected = BadCredentialsException.class, timeout = 2000)
    public void sec2500PreventAnonymousBind() {
        provider.authenticate(new UsernamePasswordAuthenticationToken("rwinch", ""));
    }
}